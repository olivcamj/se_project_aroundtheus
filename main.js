(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var t={inputSelector:".form__item",submitButtonSelector:".form__btn",inactiveButtonClass:"form__btn_disabled",inputErrorClass:"form__item_type_error",errorClass:"form__error"},r=document.querySelector(".modal_type_editProfile"),n=document.querySelector(".modal_type_addCard"),o=document.querySelector(".modal_type_imgPopup"),i=document.querySelector(".modal_type_deleteCard"),a=document.querySelector(".modal_type_setAvatar"),c=document.querySelector(".profile__editBtn"),u=document.querySelector(".profile__addBtn"),l=document.querySelector(".profile__avatar-overlay"),s=(n.querySelector(".modal__closeBtn"),document.querySelector(".form__item_el_name")),f=document.querySelector(".form__item_el_occupation"),d=(document.querySelector(".form__item_el_title"),document.querySelector(".form__item_el_url"),document.querySelector(".elements__container")),y=document.querySelector(".profile__avatar"),m=document.querySelector(".form__type_add"),p=document.querySelector(".form__type_edit");function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_(n.key),n)}}function _(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}const b=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=r},(t=[{key:"_showErrorMessage",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}},{key:"_hideErrorMessage",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e)}},{key:"_toggleButtonState",value:function(e,t){e.every((function(e){return e.validity.valid}))?(t.classList.remove("".concat(this._inactiveButtonClass)),t.disabled=!1):(t.classList.add("".concat(this._inactiveButtonClass)),t.disabled=!0)}},{key:"_setEventListeners",value:function(){var e=this,t=Array.from(this._formElement.querySelectorAll(this._inputSelector)),r=this._formElement.querySelector(this._submitButtonSelector);this._toggleButtonState(t,r),t.forEach((function(n){n.addEventListener("input",(function(){e._checkInputValidity(n),e._toggleButtonState(t,r)}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&v(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}const E=function(){return e=function e(t,r){var n=t.data,o=t.handleCardClick,i=t.handleDeleteClick,a=t.handleDeleteIcon,c=t.handleLikeCount,u=t.handleLikeClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=n.name,this._link=n.link,this._id=n._id,this._likes=n.likes,this._cardTemplateSelector=r,this._handleCardClick=o,this._handleDeleteClick=i,this._handleDeleteIcon=a,this._handleLikeCount=c,this._handleLikeClick=u},(t=[{key:"_getCardTemplate",value:function(){return document.querySelector(this._cardTemplateSelector).content.querySelector(".card").cloneNode(!0)}},{key:"id",value:function(){return this._id}},{key:"_cardRemoveBtn",value:function(){return this._card.querySelector(".card__removeBtn")}},{key:"_cardLikeCount",value:function(){return this._card.querySelector(".card__likeCount")}},{key:"_cardHeartIcon",value:function(){return this._card.querySelector(".card__heart-icon")}},{key:"_cardImage",value:function(){return this._card.querySelector(".card__img")}},{key:"_addEventListeners",value:function(){var e=this;this._cardHeartIcon().addEventListener("click",(function(){e._handleLikeClick(e._id)})),this._cardRemoveBtn().addEventListener("click",(function(){e._handleDeleteClick(e.id())})),this._cardImage().addEventListener("click",(function(){e._handleCardClick({link:e._link,name:e._text})}))}},{key:"deleteCard",value:function(){this._card.remove(),this._card=null}},{key:"hideRemoveBtn",value:function(){this._cardRemoveBtn().classList.add("card__removeBtn_type_hidden")}},{key:"_likeCount",value:function(){void 0!==this._likes&&(this._cardLikeCount().textContent=this._likes.length)}},{key:"renderLike",value:function(){this._cardHeartIcon().classList.add("card__heart-icon_active")}},{key:"wasLiked",value:function(){return this._cardHeartIcon().classList.contains("card__heart-icon_active")}},{key:"like",value:function(e){this._cardHeartIcon().classList.add("card__heart-icon_active"),this._cardLikeCount().textContent=e}},{key:"deleteLike",value:function(e){this._cardHeartIcon().classList.remove("card__heart-icon_active"),this._cardLikeCount().textContent=e}},{key:"generateCard",value:function(){return this._card=this._getCardTemplate(),this._card.querySelector(".card__text").textContent=this._name,this._cardImage().style.backgroundImage="url(".concat(this._link,")"),this._likeCount(),this._addEventListeners(),this._handleDeleteIcon(),this._card}}])&&k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j(n.key),n)}}function j(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}var P=function(){return t=function e(t){var r=t.baseUrl,n=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=r,this._headers=n},r=[{key:"getUserData",value:function(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}},{key:"getInitialCards",value:function(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).then((function(t){return function(t){var r,n="7fb54333084f7cc9cdc452a8, 6c1c8237c69449d3ebececeb, e20d70478b06753655b60e0b, 9f87343e26d7981e15bb8b00, 4527bbdef69cc7b257c44c7c, f3d4b46ba9893107e34c7c73, 952bfd8345478adc99811136".split(", "),o=[],i=function(t,r){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,r){if(t){if("string"==typeof t)return e(t,r);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var e=n.next();return c=e.done,e},e:function(e){u=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(u)throw a}}}}(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.includes(a.owner._id)||o.push(a)}}catch(e){i.e(e)}finally{i.f()}return o}(t)}))}},{key:"getUserInfo",value:function(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"addCard",value:function(e){var t=e.link,r=e.name;return fetch(this._baseUrl+"/cards",{headers:this._headers,method:"POST",body:JSON.stringify({name:r,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}},{key:"deleteCard",value:function(e){return fetch(this._baseUrl+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"editUserInfo",value:function(e){return fetch(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e.name,about:e.title})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"changeLikeStatus",value:function(e,t){return t?fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})):fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}},{key:"setUserAvatar",value:function(e){return fetch(this._baseUrl+"/users/me/avatar",{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((function(e){e.ok?e.json():Promise.reject("Error!"+e.statusText)}))}}],r&&C(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();const L=P;function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e){if("object"!=O(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==O(t)?t:t+""}const q=function(){return e=function e(t,r){var n=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=n,this._renderer=o,this._container=r},(t=[{key:"renderItems",value:function(){var e=this;this._renderedItems.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&T(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x(n.key),n)}}function x(e){var t=function(e){if("object"!=B(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==B(t)?t:t+""}const A=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=t,this._handleEscClose=this._handleEscClose.bind(this)},t=[{key:"open",value:function(){this._popupElement.classList.add("modal_visible"),document.addEventListener("keyup",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){27===e.which&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.querySelector(".modal__closeBtn").addEventListener("click",(function(){e.close()})),this._popupElement.addEventListener("click",(function(t){t.target.closest(".modal__content")||e.close()}))}}],t&&U(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H(n.key),n)}}function H(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}function V(e,t,r){return t=N(t),function(e,t){if(t&&("object"==D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,F()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(F=function(){return!!e})()}function M(){return M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=N(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},M.apply(null,arguments)}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}function J(e,t){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},J(e,t)}const $=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=V(this,t,[e]))._image=r._popupElement.querySelector(".modal__img"),r._caption=r._popupElement.querySelector(".modal__caption"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J(e,t)}(t,e),r=t,n=[{key:"open",value:function(e){var r,n,o,i=e.link,a=e.name;this._image.src=i,this._image.alt=a,this._caption.textContent=a,(r=t,n=this,o=M(N(1&3?r.prototype:r),"open",n),function(e){return o.apply(n,e)})([])}}],n&&R(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(A);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K(n.key),n)}}function K(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}function Q(e,t,r){return t=Z(t),function(e,t){if(t&&("object"==z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,W()?Reflect.construct(t,r||[],Z(e).constructor):t.apply(e,r))}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(W=function(){return!!e})()}function X(e,t,r,n){var o=Y(Z(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function Y(){return Y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Z(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Y.apply(null,arguments)}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}function ee(e,t){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ee(e,t)}const te=function(e){function t(e){var r,n=e.handleSubmitForm,o=e.popupSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Q(this,t,[o]))._handleSubmitForm=n,r._form=r._popupElement.querySelector(".form"),r._popupElement=o,r._inputList=r._popupElement.querySelectorAll(".form__item"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ee(e,t)}(t,e),r=t,n=[{key:"_getInputValues",value:function(){var e=this;return this._inputValues={},this._inputList.forEach((function(t){e._inputValues[t.name]=t.value})),this._inputValues}},{key:"setDeleteHandler",value:function(e){this._handleSubmitForm=e}},{key:"setEventListeners",value:function(){var e=this;this._form.addEventListener("submit",(function(t){t.preventDefault(),e._handleSubmitForm(e._getInputValues())})),X(t,"setEventListeners",this,3)([])}},{key:"close",value:function(){this._form.reset(),X(t,"close",this,3)([])}}],n&&G(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(A);function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oe(n.key),n)}}function oe(e){var t=function(e){if("object"!=re(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==re(t)?t:t+""}const ie=function(){return e=function e(t){var r=t.nameSelector,n=t.titleSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userName=document.querySelector(r),this._userTitle=document.querySelector(n)},(t=[{key:"getUserInfo",value:function(){return{name:this._userName.textContent,title:this._userTitle.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,r=e.title;this._userName.textContent=t,this._userTitle.textContent=r}}])&&ne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ce=new $(o);ce.setEventListeners();var ue=new te({handleSubmitForm:function(){},popupSelector:i});ue.setEventListeners();var le=new L({baseUrl:"https://around.nomoreparties.co/v1/group-4",headers:{authorization:"072f7e25-49ec-4ac7-aa51-bf0613ff728e","Content-Type":"application/json"}});le.getUserData().then((function(e){var o,i,h=(i=2,function(e){if(Array.isArray(e))return e}(o=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(o,i)||function(e,t){if(e){if("string"==typeof e)return ae(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ae(e,t):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=h[0],_=h[1],S=v._id,k=new q({items:_,renderer:function(e){var t=j(e);k.addItem(t.generateCard())}},d);k.renderItems();var g=new te({handleSubmitForm:function(e){w(!0,n),le.addCard(e).then((function(e){var t=j(e);w(!1,n),k.addItem(t.generateCard()),g.close()})).catch((function(e){return console.trace(e),new Error({err:e})}))},popupSelector:n});function w(e,t){t.querySelector(".form__btn").textContent=e?"Saving...":"Save"}g.setEventListeners(),u.addEventListener("click",(function(){g.open()}));var C=new te({handleSubmitForm:function(e){w(!0,a),le.setUserAvatar(e.link).then((function(){y.src=e.link,w(!1,a),C.close()})).catch((function(e){return console.log(e)}))},popupSelector:a});function j(e){var t=new E({data:e,handleCardClick:function(){ce.open(e)},handleDeleteClick:function(e){ue.setDeleteHandler((function(){le.deleteCard(e).then((function(){t.deleteCard(),ue.close()})).catch((function(e){return console.log(e)}))})),ue.open()},handleDeleteIcon:function(){S!==e.owner._id&&t.hideRemoveBtn()},handleLikeCount:function(){e.likes.length>0&&e.likes.forEach((function(e){e._id===S&&t.renderLike()}))},handleLikeClick:function(e){!1===t.wasLiked()?le.changeLikeStatus(e,!0).then((function(e){var r=e.likes.length;t.like(r)})).catch((function(e){return console.log(e)})):le.changeLikeStatus(e,!1).then((function(e){var r=e.likes.length;t.deleteLike(r)})).catch((function(e){return console.log(e)}))}},".card-template");return t}C.setEventListeners(),l.addEventListener("click",(function(){C.open()}));var P=new ie({nameSelector:".profile__heading",titleSelector:".profile__occupation"});P.setUserInfo({name:v.name,title:v.about}),y.src=v.avatar;var L=new te({handleSubmitForm:function(e){w(!0,r),le.editUserInfo(e).then((function(){P.setUserInfo(e),w(!1,r),L.close()})).catch((function(e){return console.log(e)}))},popupSelector:r});L.setEventListeners();var O=new b(t,p),T=new b(t,m);O.enableValidation(),T.enableValidation(),c.addEventListener("click",(function(){var e=P.getUserInfo();s.value=e.name,f.value=e.title,L.open()}))})).catch((function(e){return console.error(e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICAgIHtcbiAgICAgICAgbmFtZTogJ1lvc2VtaXRlIFZhbGxleScsXG4gICAgICAgIGxpbms6ICdodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdMYWtlIExvdWlzZScsXG4gICAgICAgIGxpbms6ICdodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdCYWxkIE1vdW50YWlucycsXG4gICAgICAgIGxpbms6ICdodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdMYXRlbWFyJyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnVmFub2lzIE5hdGlvbmFsIFBhcmsnLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzLmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ0xhZ28gZGkgQnJhaWVzJyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnJ1xuICAgIH1cbiAgXTtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRDb25maWcgPSB7XG4gICAgaW5wdXRTZWxlY3RvcjogJy5mb3JtX19pdGVtJyxcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5mb3JtX19idG4nLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdmb3JtX19idG5fZGlzYWJsZWQnLFxuICAgIGlucHV0RXJyb3JDbGFzczogJ2Zvcm1fX2l0ZW1fdHlwZV9lcnJvcicsXG4gICAgZXJyb3JDbGFzczogJ2Zvcm1fX2Vycm9yJ1xuICB9OyBcblxuLy8gV3JhcHBlcnNcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZU1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfZWRpdFByb2ZpbGUnKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWxXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9hZGRDYXJkJyk7XG5leHBvcnQgY29uc3Qgb3BlbkltZ01vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfaW1nUG9wdXAnKTtcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkTW9kYWxXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9kZWxldGVDYXJkJyk7XG5leHBvcnQgY29uc3Qgc2V0VXNlckF2YXRhck1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfc2V0QXZhdGFyJyk7XG4vLyBCdXR0b25zIGFuZCBvdGhlciBET00gZWxlbWVudHNcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0QnRuJyk7XG5leHBvcnQgY29uc3QgYWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZEJ0bicpO1xuZXhwb3J0IGNvbnN0IHNldEF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXItb3ZlcmxheScpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRDbG9zZUJ0biA9IGFkZENhcmRNb2RhbFdpbmRvdy5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlQnRuJyk7XG4vLyBGb3JtIGRhdGEgXG5leHBvcnQgY29uc3QgaW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2l0ZW1fZWxfbmFtZScpO1xuZXhwb3J0IGNvbnN0IGlucHV0T2NjdXBhdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19pdGVtX2VsX29jY3VwYXRpb24nKTtcbi8vYWRkIG5ldyBjYXJkIGRhdGFcbmV4cG9ydCBjb25zdCBhZGROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2l0ZW1fZWxfdGl0bGUnKTtcbmV4cG9ydCBjb25zdCBhZGRVcmwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faXRlbV9lbF91cmwnKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGVTZWxlY3RvciA9ICcuY2FyZC10ZW1wbGF0ZSc7XG5leHBvcnQgY29uc3QgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fY29udGFpbmVyJyk7XG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhcicpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX3R5cGVfYWRkJyk7XG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX3R5cGVfZWRpdCcpO1xuXG5leHBvcnQgY29uc3QgZ2V0RmlsdGVyZWREYXRhID0gKGRhdGEpID0+IHtcbiAgICBjb25zdCBpZHMgPSBwcm9jZXNzLmVudi5BUElfS0VZX0lEUy5zcGxpdCgnLCAnKTtcbiAgICBjb25zdCBzYWZlQ2FyZHMgPSBbXTtcbiBcbiAgICBmb3IgKGxldCBpdGVtIG9mIGRhdGEpIHtcbiAgICAgICAgaWYgKCFpZHMuaW5jbHVkZXMoaXRlbS5vd25lci5faWQpKSB7XG4gICAgICAgICAgICBzYWZlQ2FyZHMucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIHNhZmVDYXJkcztcbn0iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB9XG5cbiAgICBfc2hvd0Vycm9yTWVzc2FnZShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICAgXG4gICAgICAgIC8vIE1ha2UgaXQgdmlzaWJsZVxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfaGlkZUVycm9yTWVzc2FnZShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApOyBcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgICAgIC8vIFJlc2V0IHRoZSBtZXNzYWdlIG9uY2UgaXQncyBoaWRkZW5cbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgfVxuXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICAgICAgLy8gSWYgTk9UKCEpLCBzaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgIHRoaXMuX3Nob3dFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIElmIGl0J3MgdmFsaWQsIGhpZGUgdGhlIG1lc3NhZ2VcbiAgICAgICAgICAgIHRoaXMuX2hpZGVFcnJvck1lc3NhZ2UoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b24pIHtcbiAgICAgICAgY29uc3QgaXNWYWxpZCA9IGlucHV0TGlzdC5ldmVyeSgoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuXG4gICAgICAgIGlmKGlzVmFsaWQpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKGAke3RoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3N9YCk7XG4gICAgICAgICAgICBidXR0b24uZGlzYWJsZWQgPSBmYWxzZTsgICBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGAke3RoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3N9YCk7XG4gICAgICAgICAgICBidXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICAvLyBGaW5kIGFsbCBpbnB1dHMgaW4gYSBmb3JtIFxuICAgICAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xuICAgICAgICAvLyBGaW5kIGEgYnRuICBcbiAgICAgICAgY29uc3QgYnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgICAgIC8vRW5zdXJlcyB0aGUgYnRuIHN0YXJ0cyBvZmYgZGlzYWJsZWRcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b24pO1xuICAgICAgXG4gICAgICAgIC8vSXRlcmF0ZSB0aHJvdWdoIGlucHV0c1xuICAgICAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBpbnB1dCBldmVudCBoYW5kbGVyc1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoKGV2dCkgPT4ge1xuICAgICAgICAvLyBDYW5jZWwgdGhlIGJyb3dzZXIgZGVmYXVsdCBhY3Rpb24sIHNvIHRoYXQgY2xpY2tpbmcgb24gdGhlIHN1Ym1pdCBidXR0b24gd29uJ3QgcmVmcmVzaCB0aGUgcGFnZVxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpOyBcbiAgICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yOyIsImNsYXNzIENhcmQge1xuICAgIGNvbnN0cnVjdG9yKHsgZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDbGljaywgaGFuZGxlRGVsZXRlSWNvbiwgaGFuZGxlTGlrZUNvdW50LCBoYW5kbGVMaWtlQ2xpY2sgfSwgY2FyZFRlbXBsYXRlU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICAgICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuXG4gICAgICAgIHRoaXMuX2NhcmRUZW1wbGF0ZVNlbGVjdG9yID0gY2FyZFRlbXBsYXRlU2VsZWN0b3I7XG5cbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVJY29uID0gaGFuZGxlRGVsZXRlSWNvbjtcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNvdW50ID0gaGFuZGxlTGlrZUNvdW50O1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gICAgfVxuXG4gICAgX2dldENhcmRUZW1wbGF0ZSgpIHtcbiAgICAgICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRUZW1wbGF0ZVNlbGVjdG9yKVxuICAgICAgICAgICAgLmNvbnRlbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgICAgIHJldHVybiBjYXJkVGVtcGxhdGU7ICAgIFxuICAgIH1cblxuICAgIGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgfVxuXG4gICAgX2NhcmRSZW1vdmVCdG4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19yZW1vdmVCdG4nKTtcbiAgICB9XG5cbiAgICBfY2FyZExpa2VDb3VudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2VDb3VudCcpO1xuICAgIH1cblxuICAgIF9jYXJkSGVhcnRJY29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faGVhcnQtaWNvbicpO1xuICAgIH1cblxuICAgIF9jYXJkSW1hZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWcnKTtcbiAgICB9XG5cbiAgICBfYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2NhcmRIZWFydEljb24oKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9pZCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5fY2FyZFJlbW92ZUJ0bigpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5pZCgpKTsgXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZSgpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fdGV4dCB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZGVsZXRlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fY2FyZC5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5fY2FyZCA9IG51bGw7XG4gICAgfVxuXG4gICAgaGlkZVJlbW92ZUJ0bigpIHtcbiAgICAgICAgdGhpcy5fY2FyZFJlbW92ZUJ0bigpLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX3JlbW92ZUJ0bl90eXBlX2hpZGRlbicpO1xuICAgIH1cblxuICAgIF9saWtlQ291bnQoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5fbGlrZXMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aGlzLl9jYXJkTGlrZUNvdW50KCkudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmVuZGVyTGlrZSgpIHtcbiAgICAgICAgdGhpcy5fY2FyZEhlYXJ0SWNvbigpLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2hlYXJ0LWljb25fYWN0aXZlJyk7XG4gICAgfVxuXG4gICAgd2FzTGlrZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkSGVhcnRJY29uKCkuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19oZWFydC1pY29uX2FjdGl2ZScpO1xuICAgIH1cblxuICAgIGxpa2UoY291bnQpIHtcbiAgICAgICAgdGhpcy5fY2FyZEhlYXJ0SWNvbigpLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2hlYXJ0LWljb25fYWN0aXZlJyk7XG4gICAgICAgIHRoaXMuX2NhcmRMaWtlQ291bnQoKS50ZXh0Q29udGVudCA9IGNvdW50O1xuICAgIH1cblxuICAgIGRlbGV0ZUxpa2UoY291bnQpIHtcbiAgICAgICAgdGhpcy5fY2FyZEhlYXJ0SWNvbigpLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2hlYXJ0LWljb25fYWN0aXZlJyk7XG4gICAgICAgIHRoaXMuX2NhcmRMaWtlQ291bnQoKS50ZXh0Q29udGVudCA9IGNvdW50O1xuICAgIH1cblxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fY2FyZCA9IHRoaXMuX2dldENhcmRUZW1wbGF0ZSgpO1xuICAgICAgXG4gICAgICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RleHQnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZSgpLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLl9saW5rfSlgO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5fbGlrZUNvdW50KCk7XG4gICAgICAgIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUljb24oKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkO1xuICAgIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7IiwiaW1wb3J0IHsgZ2V0RmlsdGVyZWREYXRhIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcblxuY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gICAgfVxuXG4gICAgZ2V0VXNlckRhdGEoKXtcbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAgIH1cblxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL2NhcmRzJywge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KCdFcnJvciEnICsgcmVzLnN0YXR1c1RleHQpKVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBOZWVkZWQgdG8gbW9kaWZ5IHRoaXMgZGF0YSB0byByZW1vdmUgY2FyZHMgd2l0aCBub24tdXMgcmVsYXRlZCBpbWFnZXNcbiAgICAgICAgICAgICAgcmV0dXJuICBnZXRGaWx0ZXJlZERhdGEoZGF0YSlcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlcnMvbWUnLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdCgnRXJyb3IhJyArIHJlcy5zdGF0dXNUZXh0KSlcbiAgICB9XG5cbiAgICBhZGRDYXJkKHsgbGluaywgbmFtZSB9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcycsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgIGxpbmtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdCgnRXJyb3InICsgcmVzLnN0YXR1c1RleHQpKVxuICAgIH1cbiAgICBcbiAgICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvJyArIGNhcmRJZCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURSdcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KCdFcnJvciEnICsgcmVzLnN0YXR1c1RleHQpKVxuICAgIH1cblxuICAgIGVkaXRVc2VySW5mbyhkYXRhKSB7XG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy91c2Vycy9tZScsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgIGFib3V0OiBkYXRhLnRpdGxlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAudGhlbigocmVzKSA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoJ0Vycm9yIScgKyByZXMuc3RhdHVzVGV4dCkpXG4gICAgfVxuXG4gICAgY2hhbmdlTGlrZVN0YXR1cyhjYXJkSWQsIGJvb2xlYW4pIHtcbiAgICAgICAgaWYgKGJvb2xlYW4pIHtcbiAgICAgICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcy9saWtlcy8nICsgY2FyZElkLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJ30pIFxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KCdFcnJvciEnICsgcmVzLnN0YXR1c1RleHQpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL2NhcmRzL2xpa2VzLycgKyBjYXJkSWQsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnfSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdCgnRXJyb3IhJyArIHJlcy5zdGF0dXNUZXh0KSlcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBzZXRVc2VyQXZhdGFyKGF2YXRhcil7XG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy91c2Vycy9tZS9hdmF0YXInLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIGF2YXRhclxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge3Jlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdCgnRXJyb3IhJyArIHJlcy5zdGF0dXNUZXh0KX0pXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcGk7IiwiY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSAsIGNsYXNzU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBjbGFzc1NlbGVjdG9yO1xuICAgIH1cblxuICAgIHJlbmRlckl0ZW1zKCkge1xuICAgICAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTsgICBcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgICAgIC8vdGFrZXMgYSBET00gZWxlbWVudCBhbmQgYWRkcyBpdCB0byB0aGUgY29udGFpbmVyLlxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247IiwiY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gcG9wdXBTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIG9wZW4oKXtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21vZGFsX3Zpc2libGUnKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKXtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX3Zpc2libGUnKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSlcbiAgICB9XG5cbiAgICBfaGFuZGxlRXNjQ2xvc2UoZSkge1xuICAgICAgICBjb25zdCBFU0MgPSAyNztcbiAgICAgICAgaWYgKGUud2hpY2ggPT09IEVTQyl7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlQnRuJylcbiAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFlLnRhcmdldC5jbG9zZXN0KCcubW9kYWxfX2NvbnRlbnQnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xuXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKXtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1nJyk7XG4gICAgICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jYXB0aW9uJyk7XG4gICAgfVxuXG4gICAgb3Blbih7IGxpbmssIG5hbWUgfSkge1xuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xuICAgICAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xuICAgICAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcblxuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxuXG59ICAgXG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlOyIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcblxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGhhbmRsZVN1Ym1pdEZvcm0sIHBvcHVwU2VsZWN0b3IgfSkge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSA9IGhhbmRsZVN1Ym1pdEZvcm07XG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gcG9wdXBTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtX19pdGVtJyk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgICAvL2NvbGxlY3RzIGRhdGEgZnJvbSBhbGwgdGhlIGlucHV0IGZpZWxkcy4gIFxuICAgICAgICAvL2NvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faXRlbScpKTtcbiAgICAgICAgdGhpcy5faW5wdXRWYWx1ZXMgPSB7fTtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge3RoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWV9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0VmFsdWVzO1xuICAgIH1cblxuICAgIHNldERlbGV0ZUhhbmRsZXIoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXRGb3JtID0gaGFuZGxlcjtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgLy9uZWVkIHRvIGFkZCB0aGUgY2xpY2sgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb24gd2hpbGUgYWxzbyBhZGRpbmcgdGhlIHN1Ym1pdCBldmVudCBoYW5kbGVyLlxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgIC8vdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXRGb3JtKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgLy9yZXNldCB0aGUgcG9wdXAgaXMgY2xvc2VkIFxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtOyIsImNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgdGl0bGVTZWxlY3RvciB9KSB7XG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl91c2VyVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRpdGxlU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge25hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LCB0aXRsZTogdGhpcy5fdXNlclRpdGxlLnRleHRDb250ZW50fTtcbiAgICB9XG5cbiAgICBzZXRVc2VySW5mbyh7IG5hbWUsIHRpdGxlIH0pIHtcbiAgICAgICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICB0aGlzLl91c2VyVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvOyIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuaW1wb3J0IHsgXG4gICAgZGVmYXVsdENvbmZpZywgXG4gICAgZWRpdFByb2ZpbGVNb2RhbFdpbmRvdywgXG4gICAgYWRkQ2FyZE1vZGFsV2luZG93LCBcbiAgICBvcGVuSW1nTW9kYWxXaW5kb3csXG4gICAgZGVsZXRlQ2FyZE1vZGFsV2luZG93LFxuICAgIHNldFVzZXJBdmF0YXJNb2RhbFdpbmRvdyxcbiAgICBwcm9maWxlRWRpdEJ0biwgXG4gICAgYWRkQnRuLCBcbiAgICBzZXRBdmF0YXJCdG4sIFxuICAgIGFkZENhcmRDbG9zZUJ0biwgIFxuICAgIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxuICAgIGxpc3QsXG4gICAgYWRkQ2FyZEZvcm0sXG4gICAgZWRpdFByb2ZpbGVGb3JtLFxuICAgIGF2YXRhcixcbiAgICBNWUlELFxuICAgIGlucHV0TmFtZSxcbiAgICBpbnB1dE9jY3VwYXRpb25cbn0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IEFwaSBmcm9tICcuLi9jb21wb25lbnRzL0FwaS5qcyc7XG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xuaW1wb3J0IFBvcHVwIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXAuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcblxuY29uc3QgbW9kYWxXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uob3BlbkltZ01vZGFsV2luZG93KTtcbm1vZGFsV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGRlbGV0ZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gICAgaGFuZGxlU3VibWl0Rm9ybTogKCkgPT4ge30sXG4gICAgcG9wdXBTZWxlY3RvcjogZGVsZXRlQ2FyZE1vZGFsV2luZG93XG59KTtcblxuZGVsZXRlRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgICBiYXNlVXJsOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC00JyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHByb2Nlc3MuZW52LkFQSV9LRVksXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9XG59KTtcblxuYXBpLmdldFVzZXJEYXRhKClcbiAgICAudGhlbigoW3VzZXJEYXRhLCByZXNdKSA9PiB7IFxuICAgICAgICBjb25zdCBNWUlEID0gdXNlckRhdGFbJ19pZCddO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XG4gICAgICAgICAgICBpdGVtczogcmVzLFxuICAgICAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVuZGVyQ2FyZCA9IGNyZWF0aW5nQ2FyZEluZm8oZGF0YSk7XG4gICAgICAgICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShyZW5kZXJDYXJkLmdlbmVyYXRlQ2FyZCgpKTtcbiAgICAgICAgfVxuICAgICAgICB9LCBsaXN0KTtcbiAgICAgICAgXG4gICAgICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG5cbiAgICAgICAgY29uc3QgYWRkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgICAgICAgICAgIGhhbmRsZVN1Ym1pdEZvcm06IChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVuZGVyTG9hZGluZyh0cnVlLCBhZGRDYXJkTW9kYWxXaW5kb3cpO1xuICAgICAgICAgICAgICAgIGFwaS5hZGRDYXJkKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGluZ0NhcmRJbmZvKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBhZGRDYXJkTW9kYWxXaW5kb3cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShuZXdDYXJkLmdlbmVyYXRlQ2FyZCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZvcm0uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS50cmFjZShlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcih7IGVyciB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwb3B1cFNlbGVjdG9yOiBhZGRDYXJkTW9kYWxXaW5kb3dcbiAgICAgICAgfSk7IFxuICAgICAgICBhZGRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIFxuICAgICAgICBhZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBhZGRGb3JtLm9wZW4oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIG1vZGFsKSB7XG4gICAgICAgICAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignLmZvcm1fX2J0bicpLnRleHRDb250ZW50ID0gJ1NhdmluZy4uLic7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19idG4nKS50ZXh0Q29udGVudCA9ICdTYXZlJztcbiAgICAgICAgICAgICAgICAvL2Zvcm1TYXZlLnZhbHVlID0gJ1NhdmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHNldFVzZXJBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gICAgICAgICAgICBoYW5kbGVTdWJtaXRGb3JtOiAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJMb2FkaW5nKHRydWUsIHNldFVzZXJBdmF0YXJNb2RhbFdpbmRvdyk7XG4gICAgICAgICAgICAgICAgICAgIGFwaS5zZXRVc2VyQXZhdGFyKGRhdGEubGluaylcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmF0YXIuc3JjID0gZGF0YS5saW5rO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHNldFVzZXJBdmF0YXJNb2RhbFdpbmRvdyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VXNlckF2YXRhci5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwb3B1cFNlbGVjdG9yOiBzZXRVc2VyQXZhdGFyTW9kYWxXaW5kb3dcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2V0VXNlckF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICBzZXRBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBzZXRVc2VyQXZhdGFyLm9wZW4oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRpbmdDYXJkSW5mbyhkYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xuICAgICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsV2l0aEltYWdlLm9wZW4oZGF0YSk7ICBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhhbmRsZURlbGV0ZUNsaWNrOiAoY2FyZElkKSA9PiB7ICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlRm9ybS5zZXREZWxldGVIYW5kbGVyKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVGb3JtLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKSAgIFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlRm9ybS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBoYW5kbGVEZWxldGVJY29uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChNWUlEICE9PSBkYXRhLm93bmVyLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZC5oaWRlUmVtb3ZlQnRuKCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBoYW5kbGVMaWtlQ291bnQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEubGlrZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5saWtlcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBlbGVtZW50Ll9pZCA9PT0gTVlJRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLnJlbmRlckxpa2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaGFuZGxlTGlrZUNsaWNrOiAoY2FyZElkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYXJkLndhc0xpa2VkKCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcGkuY2hhbmdlTGlrZVN0YXR1cyhjYXJkSWQsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gcmVzdWx0Lmxpa2VzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmxpa2UoY291bnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5jaGFuZ2VMaWtlU3RhdHVzKGNhcmRJZCwgZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gcmVzdWx0Lmxpa2VzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUxpa2UoY291bnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBjYXJkVGVtcGxhdGVTZWxlY3Rvcik7XG4gICAgICAgICAgICByZXR1cm4gY2FyZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgICAgICAgICAgIG5hbWVTZWxlY3RvcjogJy5wcm9maWxlX19oZWFkaW5nJyxcbiAgICAgICAgICAgIHRpdGxlU2VsZWN0b3I6ICcucHJvZmlsZV9fb2NjdXBhdGlvbidcbiAgICAgICAgfSk7XG4gICAgICAgXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogdXNlckRhdGEubmFtZSwgdGl0bGU6IHVzZXJEYXRhLmFib3V0IH0pO1xuICAgICAgICBhdmF0YXIuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xuXG4gICAgICAgIGNvbnN0IGVkaXRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICAgICAgICAgICAgaGFuZGxlU3VibWl0Rm9ybTogKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICByZW5kZXJMb2FkaW5nKHRydWUsIGVkaXRQcm9maWxlTW9kYWxXaW5kb3cpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFwaS5lZGl0VXNlckluZm8oZGF0YSlcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBlZGl0UHJvZmlsZU1vZGFsV2luZG93KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRGb3JtLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcG9wdXBTZWxlY3RvcjogZWRpdFByb2ZpbGVNb2RhbFdpbmRvd1xuICAgICAgICB9KTtcblxuICAgICAgICBlZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIGNvbnN0IGVkaXRQcm9maWxlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZGVmYXVsdENvbmZpZywgZWRpdFByb2ZpbGVGb3JtKTtcbiAgICAgICAgY29uc3QgYWRkQ2FyZFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGRlZmF1bHRDb25maWcsIGFkZENhcmRGb3JtKTtcblxuICAgICAgICBlZGl0UHJvZmlsZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gICAgICAgIGFkZENhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4gICAgICAgIHByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBcbiAgICAgICAgICAgIGNvbnN0IGdldEZvcm1JbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgICAgICAgICAgIGlucHV0TmFtZS52YWx1ZSA9IGdldEZvcm1JbmZvLm5hbWU7XG4gICAgICAgICAgICBpbnB1dE9jY3VwYXRpb24udmFsdWUgPSBnZXRGb3JtSW5mby50aXRsZTtcbiAgICAgICAgICAgIGVkaXRGb3JtLm9wZW4oKTtcbiAgICAgICAgfSk7XG4gICAgfSlcbi5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpOyJdLCJuYW1lcyI6WyJkZWZhdWx0Q29uZmlnIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJlZGl0UHJvZmlsZU1vZGFsV2luZG93IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkQ2FyZE1vZGFsV2luZG93Iiwib3BlbkltZ01vZGFsV2luZG93IiwiZGVsZXRlQ2FyZE1vZGFsV2luZG93Iiwic2V0VXNlckF2YXRhck1vZGFsV2luZG93IiwicHJvZmlsZUVkaXRCdG4iLCJhZGRCdG4iLCJzZXRBdmF0YXJCdG4iLCJpbnB1dE5hbWUiLCJpbnB1dE9jY3VwYXRpb24iLCJsaXN0IiwiYXZhdGFyIiwiYWRkQ2FyZEZvcm0iLCJlZGl0UHJvZmlsZUZvcm0iLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50Iiwia2V5IiwidmFsdWUiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJjb25jYXQiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVFcnJvck1lc3NhZ2UiLCJfc2hvd0Vycm9yTWVzc2FnZSIsImlucHV0TGlzdCIsImJ1dHRvbiIsImV2ZXJ5IiwiZGlzYWJsZWQiLCJfdGhpcyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9zZXRFdmVudExpc3RlbmVycyIsIkNhcmQiLCJfcmVmIiwiY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJkYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVEZWxldGVJY29uIiwiaGFuZGxlTGlrZUNvdW50IiwiaGFuZGxlTGlrZUNsaWNrIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2xpa2VzIiwibGlrZXMiLCJfY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUljb24iLCJfaGFuZGxlTGlrZUNvdW50IiwiX2hhbmRsZUxpa2VDbGljayIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZCIsIl9jYXJkSGVhcnRJY29uIiwiX2NhcmRSZW1vdmVCdG4iLCJfY2FyZEltYWdlIiwiX3RleHQiLCJfY2FyZExpa2VDb3VudCIsImxlbmd0aCIsImNvbnRhaW5zIiwiY291bnQiLCJfZ2V0Q2FyZFRlbXBsYXRlIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJfbGlrZUNvdW50IiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiQXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiUHJvbWlzZSIsImFsbCIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsIl9zdGVwIiwiaWRzIiwicHJvY2VzcyIsInNwbGl0Iiwic2FmZUNhcmRzIiwiX2l0ZXJhdG9yIiwiX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiLCJzIiwibiIsImRvbmUiLCJpdGVtIiwiaW5jbHVkZXMiLCJvd25lciIsInB1c2giLCJlcnIiLCJlIiwiZiIsImdldEZpbHRlcmVkRGF0YSIsIl9yZWYyIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYXJkSWQiLCJhYm91dCIsInRpdGxlIiwiYm9vbGVhbiIsIlNlY3Rpb24iLCJjbGFzc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJlZEl0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2hpY2giLCJjbG9zZSIsInRhcmdldCIsImNsb3Nlc3QiLCJfUG9wdXAiLCJQb3B1cFdpdGhJbWFnZSIsIl9jYWxsU3VwZXIiLCJfaW1hZ2UiLCJfY2FwdGlvbiIsIl9pbmhlcml0cyIsInNyYyIsImFsdCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXRGb3JtIiwiX2hhbmRsZVN1Ym1pdEZvcm0iLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJfdGhpczIiLCJfaW5wdXRWYWx1ZXMiLCJpbnB1dCIsImhhbmRsZXIiLCJfdGhpczMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfc3VwZXJQcm9wR2V0IiwicmVzZXQiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsInRpdGxlU2VsZWN0b3IiLCJfdXNlck5hbWUiLCJfdXNlclRpdGxlIiwibW9kYWxXaXRoSW1hZ2UiLCJzZXRFdmVudExpc3RlbmVycyIsImRlbGV0ZUZvcm0iLCJhcGkiLCJhdXRob3JpemF0aW9uIiwiZ2V0VXNlckRhdGEiLCJ1c2VyRGF0YSIsIk1ZSUQiLCJjYXJkU2VjdGlvbiIsInJlbmRlckNhcmQiLCJjcmVhdGluZ0NhcmRJbmZvIiwiYWRkSXRlbSIsImdlbmVyYXRlQ2FyZCIsInJlbmRlckl0ZW1zIiwiYWRkRm9ybSIsInJlbmRlckxvYWRpbmciLCJhZGRDYXJkIiwicmVzdWx0IiwibmV3Q2FyZCIsImNhdGNoIiwiY29uc29sZSIsInRyYWNlIiwiRXJyb3IiLCJpc0xvYWRpbmciLCJtb2RhbCIsIm9wZW4iLCJzZXRVc2VyQXZhdGFyIiwibG9nIiwiY2FyZCIsInNldERlbGV0ZUhhbmRsZXIiLCJkZWxldGVDYXJkIiwiaGlkZVJlbW92ZUJ0biIsInJlbmRlckxpa2UiLCJ3YXNMaWtlZCIsImNoYW5nZUxpa2VTdGF0dXMiLCJsaWtlIiwiZGVsZXRlTGlrZSIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJlZGl0Rm9ybSIsImVkaXRVc2VySW5mbyIsImVkaXRQcm9maWxlVmFsaWRhdG9yIiwiYWRkQ2FyZFZhbGlkYXRvciIsImVuYWJsZVZhbGlkYXRpb24iLCJnZXRGb3JtSW5mbyIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==